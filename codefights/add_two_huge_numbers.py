"""
You're given 2 huge integers represented by linked lists. Each linked list element is a number from 0 to 9999 that represents a number with exactly 4 digits. The represented number might have leading zeros. Your task is to add up these huge integers and return the result in the same format.

Example

For a = [9876, 5432, 1999] and b = [1, 8001], the output should be
addTwoHugeNumbers(a, b) = [9876, 5434, 0].

Explanation: 987654321999 + 18001 = 987654340000.

For a = [123, 4, 5] and b = [100, 100, 100], the output should be
addTwoHugeNumbers(a, b) = [223, 104, 105].

Explanation: 12300040005 + 10001000100 = 22301040105.

Input/Output

[execution time limit] 4 seconds (py3)

[input] linkedlist.integer a

The first number, without its leading zeros.

Guaranteed constraints:
0 ≤ a size ≤ 104,
0 ≤ element value ≤ 9999.

[input] linkedlist.integer b

The second number, without its leading zeros.

Guaranteed constraints:
0 ≤ b size ≤ 104,
0 ≤ element value ≤ 9999.

[output] linkedlist.integer

The result of adding a and b together, returned without leading zeros in the same format.
"""


# Definition for singly-linked list:
# class ListNode(object):
#   def __init__(self, x):
#     self.value = x
#     self.next = None
#
from data_structures.linked_list import *
def addTwoHugeNumbers(a, b):
    w1 = a
    w2 = b
    a.prev = None
    b.prev = None
    c = None
    w3 = None
    lst_for_ll = []
    all_zeros = True
    while w1:
        if w1.next:
            w1.next.prev = w1
            w1 = w1.next
        else:
            break

    while w2:
        if w2.next:
            w2.next.prev = w2
            w2 = w2.next
        else:
            break

    carry = 0
    while w1 or w2:
        n1 = 0
        n2 = 0
        lst = []
        if w1:
            n1 = w1.val
        if w2:
            n2 = w2.val
        if n1 == 0 and n2 == 0:
            lst = ['0']
        count = 0
        while n1 or n2:
            all_zeros = False
            r1 = 0
            r2 = 0
            if n1:
                r1 = n1 % 10
            if n2:
                r2 = n2 % 10
            s = r1 + r2 + carry
            carry = 0
            if s > 9:
                carry = s // 10
                s %= 10
            lst.insert(0, str(s))
            count += 1
            n1 //= 10
            n2 //=10

        if count < 4 and carry:
            lst.insert(0, str(carry))
            carry = 0

        lst_for_ll.insert(0, int(''.join(lst)))

        if w1:
            w1 = w1.prev
        if w2:
            w2 = w2.prev
    if carry:
        i = 0
        while i < len(lst_for_ll)-1 and lst_for_ll[i+1] == 9:
            lst_for_ll[i+1] = 0
            i += 1
        lst_for_ll.insert(0, carry)
    i = 0
    if all_zeros:
        return ListNode(0)
    while i < len(lst_for_ll) and lst_for_ll[i] == 0:
        i += 1

    while i < len(lst_for_ll):
        n = lst_for_ll[i]
        new = ListNode(n)
        if not c:
            c = new
            w3 = c
        else:
            w3.next = new
            w3 = w3.next
        i += 1
    return c


def main():
    # [9876, 5434, 0]
    print_linked_list(addTwoHugeNumbers(
        list_to_linked_list([9876, 5432, 1999]),
        list_to_linked_list([1, 8001])))

    # # [223, 104, 105]
    print_linked_list(addTwoHugeNumbers(
        list_to_linked_list([123, 4, 5]),
        list_to_linked_list([100, 100, 100])))

    # [0]
    print_linked_list(addTwoHugeNumbers(
        list_to_linked_list([0]),
        list_to_linked_list([0])))

    # [1234, 1234, 0]
    print_linked_list(addTwoHugeNumbers(
        list_to_linked_list([1234, 1234, 0]),
        list_to_linked_list([0])))

    # [1234, 123, 0]
    print_linked_list(addTwoHugeNumbers(
        list_to_linked_list([0]),
        list_to_linked_list([1234, 123, 0])))

    # [9999, 0, 0, 0, 0, 0]
    print_linked_list(addTwoHugeNumbers(
        list_to_linked_list([1]),
        list_to_linked_list([9998, 9999, 9999, 9999, 9999, 9999])))

    # [1, 0, 0, 0, 0, 0, 0]
    print_linked_list(addTwoHugeNumbers(
        list_to_linked_list([1]),
        list_to_linked_list([9999, 9999, 9999, 9999, 9999, 9999])))

    # [8339, 6819]
    print_linked_list(addTwoHugeNumbers(
        list_to_linked_list([8339, 4510]),
        list_to_linked_list([2309])))

    # [0]
    print_linked_list(addTwoHugeNumbers(
        list_to_linked_list([0,0,0,0,0]),
        list_to_linked_list([0,0,0,0,0,0])))

    # [1]
    print_linked_list(addTwoHugeNumbers(
        list_to_linked_list([0,0,0,0,0,1]),
        list_to_linked_list([0,0,0,0,0,0])))

    # [1,0,0,0,0,0,0,0,0]
    print_linked_list(addTwoHugeNumbers(
        list_to_linked_list([9,9,9,9,9,9,9,9]),
        list_to_linked_list([1,0,0,0,0,0,0,0])))

    #
    print_linked_list(addTwoHugeNumbers(
        list_to_linked_list([3954, 7090, 3474, 1688, 269, 3940, 7831, 1, 9628, 2827, 6618, 3630, 9040, 1722, 4013, 8470, 9958, 1687, 4292,
        3251, 3943, 6269, 3492, 657, 3509, 1627, 6734, 2823, 8086, 7153, 2238, 6086, 7310, 691, 2400, 2345, 8389, 9675,
        4250, 1138, 8038, 5609, 9, 5720, 1457, 3930, 923, 9143, 7991, 9528, 8112, 2968, 9114, 5869, 3161, 9458, 261,
        5785, 9286, 4829, 4597, 8472, 538, 1027, 2192, 211, 1516, 1394, 6335, 3435, 4099, 6615, 9817, 9303, 7225, 5641,
        8752, 6219, 4731, 1155, 8557, 6938, 196, 6944, 909, 2364, 4874, 9093, 7942, 7623, 7475, 4387, 5641, 3402, 1672,
        9141, 2372, 628, 1637, 6978, 8535, 4552, 9155, 1140, 5838, 2257, 9178, 8808, 257, 1993, 9455, 4002, 2369, 8803,
        7741, 197, 6534, 6463, 3622, 34, 5649, 9904, 5810, 5783, 7121, 7526, 1742, 3394, 4290, 518, 8162, 2477, 7957,
        2855, 377, 2902, 9900, 1572, 7160, 117, 2001, 9686, 7116, 9295, 7620, 9314, 2242, 1805, 5371, 9478, 1140, 1747,
        8087, 823, 9051, 1888, 8854, 4228, 703, 6192, 7880, 328, 9609, 5564, 8560, 487, 8823, 865, 9954, 788, 1319,
        3601, 3443, 4974, 7423, 4521, 5757, 4922, 266, 441, 3447, 251, 8212, 8695, 1753, 8057, 4757, 8783, 1205, 2161,
        486, 7177, 8769, 6451, 8548, 6957, 5009, 6891, 7434, 7463, 6222, 4183, 4400, 6211, 8647, 5904, 3215, 3971, 1173,
        930, 4456, 4749, 777, 5143, 2406, 4329, 6691, 7021, 2727, 2308, 4859, 5785, 2305, 8213, 4611, 1334, 9034, 2249,
        2482, 988, 1399, 3342, 813, 8487, 6501, 2149, 2330, 6800, 3554, 5945, 5000, 87, 3408, 6700, 158, 564, 1147,
        9061, 8093, 2279, 7019, 5413, 2372, 3228, 4335, 6308, 811, 9234, 8127, 9219, 920, 6456, 9180, 6006, 5230, 3931,
        5937, 9868, 3069, 6764, 2265, 5304, 2174, 7382, 3513, 1997, 4942, 215, 5252, 2921, 7311, 1597, 6326, 7116, 6992,
        5258, 5919, 7732, 7625, 8289, 1221, 557, 5246, 9911, 5246, 9394, 648, 4838, 9553, 2645, 1427, 5553, 5455, 4529,
        2929, 134, 9403, 3145, 4660, 1797, 4519, 5222, 7386, 7733, 8429, 7917, 1457, 2151, 9069, 4234, 6224, 8827, 5861,
        2096, 9227, 459, 4160, 2058, 5543, 6002, 2383, 1932, 6426, 1923, 7588, 1859, 8270, 2464, 7295, 3261, 395, 8945,
        1189, 8816, 1676, 3964, 2754, 3354, 5638, 3795, 4823, 6117, 1098, 3246, 1455, 6148, 5482, 3582, 3523, 4755,
        8672, 2832, 7830, 6363, 7746, 5669, 1191, 4090, 9278, 771, 3522, 2612, 6064, 2404, 1857, 2334, 5291, 9678, 3806,
        1197, 7345, 6416, 7697, 4848, 6647, 46, 9008, 9826, 174, 5849, 4449, 453, 5812, 3078, 4558, 848, 1613, 1601,
        7667, 7619, 5990, 179, 5722, 4950, 1189, 7574, 1325, 9743, 2056, 9980, 5692, 7528, 437, 9793, 1754, 8392, 9030,
        6076, 5695, 7682, 4808, 8319, 8829, 9203, 2077, 2563, 8954, 3019, 7204, 6738, 3463, 5556, 2896, 5663, 8898,
        2115, 4767, 9510, 5390, 7043, 7748, 2179, 8875, 7292, 2918, 5916, 1020, 4622, 5245, 3889, 1247, 9190, 6913,
        9656, 719, 1457, 3652, 9877, 9801, 4826, 450, 6385, 4894, 6807, 6723, 4692, 1529, 867, 4703, 8208, 8710, 4284,
        734, 1949, 9782, 4287, 8558, 6033, 3520, 9641, 2195, 7800, 756, 5841, 6849, 8816, 8544, 1248, 2781, 6769, 5072,
        2017, 9965, 3797, 3789, 5609, 8692, 7625, 1215, 3873, 5467, 7120, 9922, 7255, 3590, 9293, 4109, 13, 8127, 92,
        4265, 1141, 4187, 5729, 6467, 9792, 1994, 5815, 4393, 4784, 6101, 7960, 8182, 2592, 9014, 7608, 2681, 9987,
        3962, 5044, 886, 1216, 600, 3930, 1835, 9979, 8737, 2101, 4897, 8763, 5232, 3553, 3432, 674, 4191, 74, 4470,
        7353, 2184, 8414, 4836, 7478, 9605, 5374, 9791, 7593, 8356, 6070, 482, 7399, 3911, 8853, 7506, 8089, 6382, 2419,
        2514, 3195, 843, 3574, 7216, 559, 4967, 2222, 4104, 239, 3076, 5537, 4719, 3535, 8838, 1345, 766, 4241, 5348,
        6640, 8236, 7768, 7457, 8706, 3819, 7179, 925, 7537, 1667, 5147, 6355, 1742, 252, 5940, 9164, 9903, 9958, 8031,
        9757, 6301, 478, 6519, 5694, 7325, 4082, 3105, 9828, 9686, 3281, 2862, 8306, 2613, 483, 1565, 6241, 6027, 3875,
        5438, 3765, 4975, 2063, 6218, 4285, 7896, 3947, 2918, 1050, 3147, 3817, 3498, 280, 3543, 3257, 2427, 9818, 5258,
        3926, 1993, 1734, 2594, 527, 3200, 745, 9590, 3571, 2756, 675, 9574, 6363, 3695, 8917, 5516, 978, 8949, 8671,
        7102, 2595, 1177, 1845, 5837, 8906, 7115, 6028, 1790, 8606, 6855, 9021, 4639, 5359, 2628, 1206, 6092, 936, 7194,
        3529, 8369, 5813, 4663, 9326, 2261, 7432, 1933, 9338, 772, 5756, 1791, 7033, 9050, 9089, 7255, 6602, 3950, 7484,
        4591, 7923, 5605, 239, 3105, 8270, 1586, 6211, 4884, 7894, 3114, 7292, 7263, 6262, 4900, 2030, 9178, 4239, 8854,
        3947, 2044, 4257, 2466, 5390, 1279, 3291, 5462, 200, 1271, 3417, 2467, 4657, 4121, 2316, 4741, 5581, 8734, 4793,
        2225, 1388, 3610, 3079, 2402, 901, 6628, 3664, 8977, 6608, 7781, 2242, 5628, 1629, 6723, 438, 6175, 5004, 3888,
        8871, 8263, 300, 3069, 9160, 8691, 3356, 6848, 5930, 6471, 7487, 9928, 2037, 9852, 5606, 7489, 6628, 5436, 4530,
        9560, 8429, 8285, 2458, 8457, 3314, 9287, 8549, 9614, 6252, 2513, 8588, 4032, 3066, 2215, 8804, 5129, 3313,
        1892, 3814, 7388, 5495, 6949, 2548, 9883, 8365, 1232, 9540, 8142, 3698, 4247, 3245, 5563, 3111, 5870, 6261, 550,
        1932, 1362, 1368, 7460, 640, 8598, 4792, 156, 3873, 3598, 2830]),
        list_to_linked_list([4046, 5870, 5745, 7145, 8191, 8093, 2716, 3453, 3796, 4981, 1176, 2937, 4341, 7604, 1255, 1051, 8524, 6002,
        5651, 7782, 5609, 6791, 2572, 3749, 2791, 8379, 9582, 6075, 3290, 1666, 6901, 2564, 8617, 1144, 5561, 4596,
        9382, 6989, 2498, 1822, 1789, 6219, 5199, 4263, 7614, 7699, 2249, 6805, 3529, 9908, 1311, 5766, 5296, 8474, 320,
        1586, 6672, 7982, 8949, 5283, 5250, 2486, 5729, 9778, 3934, 1334, 2696, 4126, 7605, 7844, 594, 8064, 6867, 8881,
        2989, 8286, 8308])))

if __name__ == '__main__':
    main()